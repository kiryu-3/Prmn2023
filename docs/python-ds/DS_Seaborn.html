<!DOCTYPE html>
<html>
<head>
<title>DS_Seaborn.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="seaborn">Seaborn</h1>
<ul>
<li><a href="#seaborn">Seaborn</a>
<ul>
<li><a href="#seaborn%E3%81%A8%E3%81%AF">Seabornとは</a></li>
<li><a href="#%E3%83%92%E3%82%B9%E3%83%88%E3%82%B0%E3%83%A9%E3%83%A0">ヒストグラム</a>
<ul>
<li><a href="#snshistplot">sns.histplot()</a></li>
<li><a href="#snsdisplot">sns.displot()</a></li>
<li><a href="#snsjointplot">sns.jointplot()</a></li>
<li><a href="#snspairplot">sns.pairplot()</a></li>
</ul>
</li>
<li><a href="#categorical-plot">Categorical Plot</a>
<ul>
<li><a href="#snscountplot">sns.countplot()</a></li>
<li><a href="#snsbarplot">sns.barplot()</a></li>
<li><a href="#snsboxplot">sns.boxplot()</a></li>
<li><a href="#snsviolinplot">sns.violinplot()</a></li>
<li><a href="#snsswarmplot">sns.swarmplot()</a></li>
</ul>
</li>
<li><a href="#%E3%83%92%E3%83%BC%E3%83%88%E3%83%9E%E3%83%83%E3%83%97">ヒートマップ</a></li>
<li><a href="#seaborn%E3%81%AE%E8%A3%85%E9%A3%BE%E3%81%A8%E4%BB%98%E5%B1%9E%E6%83%85%E5%A0%B1">Seabornの装飾と付属情報</a>
<ul>
<li><a href="#snsset">sns.set()</a>
<ul>
<li><a href="#context">context</a></li>
<li><a href="#style">style</a></li>
<li><a href="#palette">palette</a></li>
</ul>
</li>
<li><a href="#%E4%BB%98%E5%B1%9E%E6%83%85%E5%A0%B1">付属情報</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="page-break-before:always"></div>
<h2 id="seaborn%E3%81%A8%E3%81%AF">Seabornとは</h2>
<p><strong>Seaborn</strong>もmatplotlibと同じように、データの可視化をするライブラリです。<br>
中でmatplotlibを使っていますが、よりきれいに表示することができます。より実践的です。</p>
<p><img src="https://imgur.com/IwusMXK.png" alt="リンクテキスト"></p>
<p>これまでに比べると量が少ないと思います。</p>
<p>GoogleColabやJupyter Labといった環境下では、最初から入っているため改めて入れる必要はありません。<br>
自分で入れる場合は<code>conda install seaborn</code>や<code>pip install seaborn</code>という記述をします。</p>
<p>Seabornをimportする際、<code>sns</code>とするのが一般的です。</p>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns

<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
!pip install japanize-matplotlib
<span class="hljs-keyword">import</span> japanize_matplotlib
</div></code></pre>
<div style="page-break-before:always"></div>
<h2 id="%E3%83%92%E3%82%B9%E3%83%88%E3%82%B0%E3%83%A9%E3%83%A0">ヒストグラム</h2>
<p>matplotlibでも学習したヒストグラムです。最頻出です。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df.head(<span class="hljs-number">3</span>)
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
    </tr>
  </tbody>
</table>
</div>
<div style="page-break-before:always"></div>
<h3 id="snshistplot">sns.histplot()</h3>
<p>ヒストグラムを作るには <strong><code>sns.histplot()</code></strong> 関数を使います。</p>
<p>今回は、<code>pclass</code>カラムのデータをヒストグラム化します。</p>
<pre class="hljs"><code><div>sns.histplot(df, x=<span class="hljs-string">"pclass"</span>)
</div></code></pre>
<p><img src="output_10_1.png" alt="png"></p>
<p>引数<code>element</code>を<strong>step</strong>と指定すると、棒グラフの境が消えます。</p>
<pre class="hljs"><code><div>sns.histplot(df, x=<span class="hljs-string">"pclass"</span>, element=<span class="hljs-string">'step'</span>)
</div></code></pre>
<p><img src="output_12_1.png" alt="png"></p>
<p>引数<code>hue</code>に「<strong>分割したい列名</strong>」を指定すると、<br>
項目ごとにグラフ化することができます。</p>
<p>年齢別の生存者の割合について確認しましょう。</p>
<pre class="hljs"><code><div>sns.histplot(df, x=<span class="hljs-string">"pclass"</span>, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_14_1.png" alt="png"></p>
<p>引数<code>multiple</code>を<strong>stack</strong>と指定することで、「積み上げグラフ」を作成できます。</p>
<pre class="hljs"><code><div>sns.histplot(df, x=<span class="hljs-string">"pclass"</span>, hue=<span class="hljs-string">'survived'</span>, multiple=<span class="hljs-string">'stack'</span>)
</div></code></pre>
<p><img src="output_16_1.png" alt="png"></p>
<p>引数<code>multiple</code>を<strong>fill</strong>と指定することで、「100%積み上げグラフ」を作成できます。</p>
<pre class="hljs"><code><div>sns.histplot(df, x=<span class="hljs-string">"pclass"</span>, hue=<span class="hljs-string">'survived'</span>, multiple=<span class="hljs-string">'fill'</span>)
</div></code></pre>
<p><img src="output_18_1.png" alt="png"></p>
<p>客室等級が低いほど志望者の割合が多くなることが分かります。</p>
<h3 id="snsdisplot">sns.displot()</h3>
<p>2変量のヒストグラムを取得したい場合は、<strong><code>sns.displot()</code></strong> 関数を使います。<br>
今回は<code>age</code>カラムと<code>fare</code>カラムのデータを作成します。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df.head(<span class="hljs-number">3</span>)
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>7.2500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>71.2833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>7.9250</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="hljs"><code><div>df = df.dropna(subset=[<span class="hljs-string">"age"</span>])  <span class="hljs-comment"># 今回は欠損値の行をdrop</span>
</div></code></pre>
<pre class="hljs"><code><div>sns.displot(df, x=<span class="hljs-string">"age"</span>, y=<span class="hljs-string">"fare"</span>, alpha=<span class="hljs-number">1</span>)
</div></code></pre>
<p><img src="output_23_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>引数<code>hue</code>に「分割したい列名」を指定すると、<br>
項目ごとにグラフ化することができます。</p>
<pre class="hljs"><code><div>sns.displot(df, x=<span class="hljs-string">"age"</span> , y=<span class="hljs-string">"fare"</span>, alpha=<span class="hljs-number">1</span>, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_25_1.png" alt="png"></p>
<p>高いチケットを持っている客は比較的生き残ったこと、<br>
高齢の客は比較的亡くなった方が多いこと、などが分かります。</p>
<div style="page-break-before:always"></div>
<h3 id="snsjointplot">sns.jointplot()</h3>
<p>2変数の分布を見ることができます。<br>
散布図とヒストグラムの両方を可視化できるのが特徴です。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df.head(<span class="hljs-number">3</span>)
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>7.2500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>71.2833</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>7.9250</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="hljs"><code><div>sns.jointplot(data=df, x=<span class="hljs-string">"age"</span>,  y=<span class="hljs-string">"fare"</span>, alpha=<span class="hljs-number">0.5</span>)
</div></code></pre>
<p><img src="output_30_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>引数<code>hue</code>に「分割したい列名」を指定すると、<br>
項目ごとにグラフ化することができます。</p>
<pre class="hljs"><code><div>sns.jointplot(data=df, x=<span class="hljs-string">"age"</span>,  y=<span class="hljs-string">"fare"</span>, alpha=<span class="hljs-number">0.5</span>, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_32_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>引数 <strong><code>kind</code></strong> で <strong><code>reg</code></strong> と指定すると、2変数の大まかな関係を線で引くことができます。<br>
（カーネル密度推定）</p>
<pre class="hljs"><code><div>sns.jointplot(data=df, x=<span class="hljs-string">"age"</span>,  y=<span class="hljs-string">"fare"</span>,  kind=<span class="hljs-string">'reg'</span>)
</div></code></pre>
<p><img src="output_34_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>引数<code>kind</code>を <strong><code>hex</code></strong> と指定すると、散布図を六角形のヒートマップ形式で表示します。</p>
<pre class="hljs"><code><div>sns.jointplot(data=df, x=<span class="hljs-string">"age"</span>,  y=<span class="hljs-string">"fare"</span>, kind=<span class="hljs-string">'hex'</span>)
</div></code></pre>
<p><img src="output_36_1.png" alt="png"></p>
<p>データの重なり具合がより分かりやすくなったと思います。</p>
<div style="page-break-before:always"></div>
<h3 id="snspairplot">sns.pairplot()</h3>
<p>Seabornの中で再頻出の関数です。<br>
DataFrame内にある全ての数値項目のペアのplotを表示できます。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
</div></code></pre>
<pre class="hljs"><code><div>sns.pairplot(df[[<span class="hljs-string">'age'</span>, <span class="hljs-string">'fare'</span>, <span class="hljs-string">'pclass'</span>, <span class="hljs-string">'survived'</span>]])  <span class="hljs-comment"># 不要なカラムは除く</span>
</div></code></pre>
<p><img src="output_41_1.png" alt="png"></p>
<p>同じカラムが交差するところは、そのカラムのヒストグラムが表示されます。</p>
<div style="page-break-before:always"></div>
<p><code>pairplot</code>では引数 <strong><code>hue</code></strong> を使ってデータの色分けをすることが多いです。<br>
カテゴリごとにマーカーの色を変えることができます。</p>
<pre class="hljs"><code><div>sns.pairplot(df[[<span class="hljs-string">'age'</span>, <span class="hljs-string">'fare'</span>, <span class="hljs-string">'pclass'</span>, <span class="hljs-string">'survived'</span>]], hue=<span class="hljs-string">'survived'</span>, plot_kws={<span class="hljs-string">'alpha'</span>:<span class="hljs-number">0.5</span>})
</div></code></pre>
<p><img src="output_44_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h2 id="categorical-plot">Categorical Plot</h2>
<p>カテゴリーの値が入ったカラムに対してのplotを <strong>Categorical Plot</strong> といいます。<br>
いくつか用意されています。</p>
<h3 id="snscountplot">sns.countplot()</h3>
<p>データの数を単純にカテゴリ別に比べます。</p>
<p><code>sibsp</code>（兄弟・配偶者）カラムと<code>parch</code>（親・子）カラムを足して<br>
<code>partner</code>カラムを作っていきます。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df.head(<span class="hljs-number">3</span>)
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
<pre class="hljs"><code><div>df[<span class="hljs-string">"partner"</span>] = df[<span class="hljs-string">"sibsp"</span>] + df[<span class="hljs-string">"parch"</span>]
</div></code></pre>
<p>人数によって生存者がどうなっているのかを確認してみましょう。</p>
<pre class="hljs"><code><div>sns.countplot(<span class="hljs-string">'partner'</span>, data=df, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_52_2.png" alt="png"></p>
<p>家族連れの人の方が生存者の割合が高いことが分かります。</p>
<p>家族の人数ごとではなく、家族がいたかどうかで<br>
割合の違いを見てみましょう。</p>
<div style="page-break-before:always"></div>
<pre class="hljs"><code><div>mapping = {<span class="hljs-literal">True</span>:<span class="hljs-string">"alone"</span>, <span class="hljs-literal">False</span>:<span class="hljs-string">"with family"</span>}
df[<span class="hljs-string">"alone"</span>] = df[<span class="hljs-string">"alone"</span>].map(mapping)
df[<span class="hljs-string">"alone"</span>]
</div></code></pre>
<pre><code>0      with family
1      with family
2            alone
3      with family
4            alone
          ...     
886          alone
887          alone
888    with family
889          alone
890          alone
Name: alone, Length: 891, dtype: object
</code></pre>
<pre class="hljs"><code><div>sns.countplot(<span class="hljs-string">'alone'</span>, data=df, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_56_2.png" alt="png"></p>
<p>具体的な割合を見てみましょう。</p>
<pre class="hljs"><code><div>df.groupby(<span class="hljs-string">"alone"</span>).mean()
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>adult_male</th>
      <th>partner</th>
    </tr>
    <tr>
      <th>alone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alone</th>
      <td>0.303538</td>
      <td>2.400372</td>
      <td>32.220297</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>21.242689</td>
      <td>0.763501</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>with family</th>
      <td>0.505650</td>
      <td>2.169492</td>
      <td>26.413452</td>
      <td>1.316384</td>
      <td>0.960452</td>
      <td>48.832275</td>
      <td>0.358757</td>
      <td>2.276836</td>
    </tr>
  </tbody>
</table>
</div>
<p>生存率は一人の方が約30%、家族連れの方が約50%であることが分かります。</p>
<div style="page-break-before:always"></div>
<h3 id="snsbarplot">sns.barplot()</h3>
<p>カテゴリーごとに分けて、指定したカラムの平均値を比較する棒グラフを作ることができます。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df[<span class="hljs-string">"partner"</span>] = df[<span class="hljs-string">"sibsp"</span>] + df[<span class="hljs-string">"parch"</span>]
df[<span class="hljs-string">"survived"</span>] *= <span class="hljs-number">100</span>  <span class="hljs-comment"># %表示</span>
</div></code></pre>
<p>家族の数ごとの生存率を確認するグラフを書いてみましょう。</p>
<pre class="hljs"><code><div>sns.barplot(x=<span class="hljs-string">'partner'</span>, y=<span class="hljs-string">'survived'</span>, data=df)
</div></code></pre>
<p><img src="output_63_1.png" alt="png"></p>
<p>黒い線は<strong>エラーバー</strong>と呼ばれるもので、不確かさを示すものです。<br>
<a href="https://3pysci.com/python-matplotlib-6/">こちら</a>ではエラーバーについていろいろな話があります。</p>
<p>平均値以外の値を比較したい場合は、引数 <strong><code>estimator</code></strong> を使います。<br>
Numpyの関数で指定します。</p>
<p>＜例＞ チケットクラスごとの年齢の平均値と中央値を表示する</p>
<pre class="hljs"><code><div><span class="hljs-comment"># 平均値の比較</span>
sns.barplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df)
</div></code></pre>
<p><img src="output_66_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<pre class="hljs"><code><div>df.groupby(<span class="hljs-string">"pclass"</span>).mean()[<span class="hljs-string">"age"</span>]
</div></code></pre>
<pre><code>pclass
1    38.233441
2    29.877630
3    25.140620
Name: age, dtype: float64
</code></pre>
<pre class="hljs"><code><div><span class="hljs-comment"># 中央値の比較</span>
sns.barplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, estimator=np.median)
</div></code></pre>
<p><img src="output_68_1.png" alt="png"></p>
<pre class="hljs"><code><div>df.groupby(<span class="hljs-string">"pclass"</span>).median()[<span class="hljs-string">"age"</span>]
</div></code></pre>
<pre><code>pclass
1    37.0
2    29.0
3    24.0
Name: age, dtype: float64
</code></pre>
<div style="page-break-before:always"></div>
<h3 id="snsboxplot">sns.boxplot()</h3>
<p>matplotlibでも学習した箱ひげ図と同じですが、<br>
Seabornの方が使い勝手の良さと綺麗さからよく好まれるようです。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
</div></code></pre>
<pre class="hljs"><code><div>sns.boxplot(x=<span class="hljs-string">"pclass"</span> , y=<span class="hljs-string">"age"</span>, data=df)
</div></code></pre>
<p><img src="output_72_1.png" alt="png"></p>
<p>引数<code>hue</code>に「分割したい列名」を指定すると、<br>
さらに分割することができます。</p>
<pre class="hljs"><code><div>sns.boxplot(x=<span class="hljs-string">"pclass"</span> , y=<span class="hljs-string">"age"</span>, data=df, hue=<span class="hljs-string">"survived"</span>)
</div></code></pre>
<p><img src="output_74_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h3 id="snsviolinplot">sns.violinplot()</h3>
<p>データの分布に応じて箱の形を変えることができます。</p>
<p>平均にデータが集まることが多いために、バイオリンのような形になります。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
</div></code></pre>
<pre class="hljs"><code><div>sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df)
</div></code></pre>
<p><img src="output_78_1.png" alt="png"></p>
<pre class="hljs"><code><div>sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, hue=<span class="hljs-string">"survived"</span>)
</div></code></pre>
<p><img src="output_79_1.png" alt="png"></p>
<p>統計量の比較だけを把握したい場合は<code>boxplot</code>を、<br>
全体の分布の様子を把握したい場合は<code>violinplot</code>を使うようにしましょう。</p>
<div style="page-break-before:always"></div>
<p>引数<code>split</code>をTrueに、引数<code>inner</code>を<strong>quart</strong>にすることで、見やすいグラフが完成します。</p>
<pre class="hljs"><code><div>sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, split=<span class="hljs-literal">True</span> , inner=<span class="hljs-string">"quart"</span>)
</div></code></pre>
<p><img src="output_82_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h3 id="snsswarmplot">sns.swarmplot()</h3>
<p>violinplotでは表示しているのは密度であるため、実際の乗客数を比較することができません。</p>
<p>そこで使うのが<strong>swarmplot</strong>です。実際の分布をみることができます。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
</div></code></pre>
<pre class="hljs"><code><div>sns.swarmplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df)
</div></code></pre>
<p><img src="output_86_2.png" alt="png"></p>
<p>1stクラスは他のクラスに比べて年配の方が多そうです。</p>
<p>プロットが潰れているところがあるので、<br>
プロットの全体のサイズを変えましょう。</p>
<pre class="hljs"><code><div>sns.swarmplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, size=<span class="hljs-number">4</span>)
</div></code></pre>
<p><img src="output_89_2.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>引数<code>hue</code>を指定することもできます。</p>
<pre class="hljs"><code><div>sns.swarmplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, size=<span class="hljs-number">4</span>, hue=<span class="hljs-string">'survived'</span>)
</div></code></pre>
<p><img src="output_91_2.png" alt="png"></p>
<p>3rdクラスの方（等級が低い方）の死亡者の割合の高さが分かります。</p>
<p>swarmplotでは統計量は出てきません。<br>
boxplotやviolinplotと、特性を考えながら合わせて使うようにしましょう。</p>
<div style="page-break-before:always"></div>
<h2 id="%E3%83%92%E3%83%BC%E3%83%88%E3%83%9E%E3%83%83%E3%83%97">ヒートマップ</h2>
<p>表の各値の大きさに応じて色付けした図を<strong>ヒートマップ</strong>といいます。<br>
一目で値の大きさが分かります。また、データの傾向を見ることができます。</p>
<p>ヒートマップは、<strong>データサイエンスでは大変よく使われる図</strong>です。<br>
　・相関表：各カラム間の相関を示すもの（<a href="https://datawokagaku.com/correlation_coefficient/">こちら</a>が参考になります）<br>
　・混同行列：分類器の分類を表にしたもの（<a href="https://bit.ly/3YKkuim">こちら</a>が参考になります）</p>
<p>今回は実際に相関表を作り、ヒートマップを見ていきましょう。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df.corr()  <span class="hljs-comment"># 相関表の作成</span>
</div></code></pre>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>adult_male</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>survived</th>
      <td>1.000000</td>
      <td>-0.338481</td>
      <td>-0.077221</td>
      <td>-0.035322</td>
      <td>0.081629</td>
      <td>0.257307</td>
      <td>-0.557080</td>
      <td>-0.203367</td>
    </tr>
    <tr>
      <th>pclass</th>
      <td>-0.338481</td>
      <td>1.000000</td>
      <td>-0.369226</td>
      <td>0.083081</td>
      <td>0.018443</td>
      <td>-0.549500</td>
      <td>0.094035</td>
      <td>0.135207</td>
    </tr>
    <tr>
      <th>age</th>
      <td>-0.077221</td>
      <td>-0.369226</td>
      <td>1.000000</td>
      <td>-0.308247</td>
      <td>-0.189119</td>
      <td>0.096067</td>
      <td>0.280328</td>
      <td>0.198270</td>
    </tr>
    <tr>
      <th>sibsp</th>
      <td>-0.035322</td>
      <td>0.083081</td>
      <td>-0.308247</td>
      <td>1.000000</td>
      <td>0.414838</td>
      <td>0.159651</td>
      <td>-0.253586</td>
      <td>-0.584471</td>
    </tr>
    <tr>
      <th>parch</th>
      <td>0.081629</td>
      <td>0.018443</td>
      <td>-0.189119</td>
      <td>0.414838</td>
      <td>1.000000</td>
      <td>0.216225</td>
      <td>-0.349943</td>
      <td>-0.583398</td>
    </tr>
    <tr>
      <th>fare</th>
      <td>0.257307</td>
      <td>-0.549500</td>
      <td>0.096067</td>
      <td>0.159651</td>
      <td>0.216225</td>
      <td>1.000000</td>
      <td>-0.182024</td>
      <td>-0.271832</td>
    </tr>
    <tr>
      <th>adult_male</th>
      <td>-0.557080</td>
      <td>0.094035</td>
      <td>0.280328</td>
      <td>-0.253586</td>
      <td>-0.349943</td>
      <td>-0.182024</td>
      <td>1.000000</td>
      <td>0.404744</td>
    </tr>
    <tr>
      <th>alone</th>
      <td>-0.203367</td>
      <td>0.135207</td>
      <td>0.198270</td>
      <td>-0.584471</td>
      <td>-0.583398</td>
      <td>-0.271832</td>
      <td>0.404744</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
<div style="page-break-before:always"></div>
<p>あとは <strong><code>sns.heatmap()</code></strong> の中にこの相関表を入れるだけです。</p>
<pre class="hljs"><code><div>sns.heatmap(df.corr())
</div></code></pre>
<p><img src="output_100_1.png" alt="png"></p>
<p>引数 <strong><code>annot</code></strong> をTrueに指定すると、各マスに数値を入れてくれます。原則つけるようにしましょう。</p>
<p>また、引数 <strong><code>cmap</code></strong> にカラーマップを指定すると色のグラデ―ジョンを指定できます。<br>
<code>coolwarm</code>や<code>hot</code>、<code>plasma</code>などが有名です。</p>
<pre class="hljs"><code><div>sns.heatmap(df.corr(), cmap=<span class="hljs-string">'coolwarm'</span>, annot=<span class="hljs-literal">True</span>)
</div></code></pre>
<p><img src="output_102_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h2 id="seaborn%E3%81%AE%E8%A3%85%E9%A3%BE%E3%81%A8%E4%BB%98%E5%B1%9E%E6%83%85%E5%A0%B1">Seabornの装飾と付属情報</h2>
<p>matplotlibでも同じような話がありました。</p>
<p>Seabornはそもそもデフォルトできれいなグラフが描けるので、<br>
仕様頻度はそこまで高くないかもしれません。</p>
<h3 id="snsset">sns.set()</h3>
<p><strong><code>sns.set()</code></strong> のパラメータを加えることで、グラフを装飾できます。</p>
<h4 id="context">context</h4>
<p>引数<code>context</code>は <strong><code>paper</code></strong>、<strong><code>notebook</code></strong>、<strong><code>talk</code></strong>、<strong><code>poster</code></strong> の4つの値を取ります。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
df = df.dropna(subset=[<span class="hljs-string">'age'</span>])  <span class="hljs-comment"># 欠損値のあるレコードはdrop</span>
</div></code></pre>
<pre class="hljs"><code><div>sns.set(context=<span class="hljs-string">"notebook"</span>)
<span class="hljs-comment"># sns.set_context("notebook")  でも同意</span>
sns.histplot(df[<span class="hljs-string">"age"</span>])
</div></code></pre>
<p><img src="output_108_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<p>プレゼンなどを想定し、文字を大きくしたい場合は<code>poster</code>を使うことが多いです。<br>
そうでない場合はデフォルトである<code>notebook</code>で問題ないようです。</p>
<pre class="hljs"><code><div>sns.set(context=<span class="hljs-string">"poster"</span>)
<span class="hljs-comment"># sns.set_context("poster")  でも同意</span>
sns.histplot(df[<span class="hljs-string">"age"</span>])
</div></code></pre>
<p><img src="output_110_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h4 id="style">style</h4>
<p>引数<code>style</code>は <strong><code>darkgrid</code></strong>、<strong><code>whitegrid</code></strong>、<strong><code>dark</code></strong>、<strong><code>white</code></strong>、<strong><code>ticks</code></strong> の5つの値を取ります。</p>
<pre class="hljs"><code><div>sns.set(context=<span class="hljs-string">"notebook"</span> , style=<span class="hljs-string">"darkgrid"</span>)
sns.histplot(df[<span class="hljs-string">"age"</span>])
</div></code></pre>
<p><img src="output_112_1.png" alt="png"></p>
<p>デフォルトは<code>darkgrid</code>ですが、好みのものを使うようにしましょう。</p>
<p><code>ticks</code>を指定した場合はplotに軸と枠ができますが、<br>
<strong><code>sns.despine()</code></strong> を使うと軸を消すことができます。</p>
<pre class="hljs"><code><div>sns.set(context=<span class="hljs-string">"notebook"</span> , style=<span class="hljs-string">"ticks"</span>)
sns.histplot(df[<span class="hljs-string">"age"</span>])
sns.despine()
</div></code></pre>
<p><img src="output_115_0.png" alt="png"></p>
<p>引数には <strong><code>top</code></strong>、<strong><code>right</code></strong>、<strong><code>left</code></strong>、<strong><code>bottom</code></strong> をbool型の値で指定できます。</p>
<p>指定するとそれぞれを表示を切り替えることができます。<br>
デフォルトは<code>top</code>、<code>right</code>がTrueになっています。</p>
<div style="page-break-before:always"></div>
<h4 id="palette">palette</h4>
<p>色のパレットを指定することができます。<br>
先ほど引数<code>cmap</code>に指定していたものになります。</p>
<pre class="hljs"><code><div>sns.set(palette=<span class="hljs-string">'coolwarm'</span>)
sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df)
</div></code></pre>
<p><img src="output_118_1.png" alt="png"></p>
<p><code>sns.set()</code>内で指定した<code>palette</code>は、<strong>hueの色にしか適用されません</strong>。少し見にくいと思います。</p>
<p>violinplot自体の色を変えたいときは、violinplot内で引数<code>palette</code>を指定しましょう。</p>
<pre class="hljs"><code><div>sns.set(palette=<span class="hljs-string">'coolwarm'</span>)
sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df, palette=<span class="hljs-string">"bright"</span>)
<span class="hljs-comment"># 興味のある方は「hsv」,「twilight」などに変更してみてください</span>
</div></code></pre>
<p><img src="output_120_1.png" alt="png"></p>
<div style="page-break-before:always"></div>
<h3 id="%E4%BB%98%E5%B1%9E%E6%83%85%E5%A0%B1">付属情報</h3>
<p><strong>Seabornは中でmatplotlibを含んでいる</strong>ので、<br>
同じようにタイトルや軸の名前を指定することができます。</p>
<p>同様にして、<strong><code>plt.savefig()</code></strong> で保存も可能です。</p>
<pre class="hljs"><code><div>df = sns.load_dataset(<span class="hljs-string">'titanic'</span>)
</div></code></pre>
<pre class="hljs"><code><div>sns.set(palette=<span class="hljs-string">'coolwarm'</span>)
sns.violinplot(x=<span class="hljs-string">'pclass'</span>, y=<span class="hljs-string">'age'</span>, data=df)
</div></code></pre>
<p><img src="output_124_1.png" alt="png"></p>
<pre class="hljs"><code><div>plt.savefig(<span class="hljs-string">"seaborn_sample.png"</span>)
</div></code></pre>

</body>
</html>
